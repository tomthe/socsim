## Event competition

At the start of every month in the simulation, every living person has
exactly one event scheduled for some future date. In the course of this
month, all scheduled events are executed. Events affect the individuals
for whom they are scheduled but may also affect spouses and others to
whom they are connected. All births, deaths, marriages and group
transitions that are scheduled for the current month are executed in
random order. After a person’s event is executed, unless that event was
death, a new event must be scheduled. New events are scheduled by an
“event competition.” This event competition is also held once for each
living person at the beginning of each simulation segment (that is,
every time the demographic rates or societal constants change).

Each event for which the individual is at risk (e.g., men rarely give
birth) can be modeled as a piecewise exponential distribution. A random
number is used to generate a waiting time until this event occurs (which
is bounded by the individual’s maximum possible age at death). The
individual’s next event is the one with the shortest randomly generated
waiting time. The event competition thus follows a competing risk
framework wherein the probability of each event is independent of all
others.

## Generating potential waiting times

The waiting time algorithm is conceptually equivalent to drawing a
random number u, from a uniform (0,1) distribution, calling u the
probability that the event will not yet have occurred, then finding the
first month by which the probability of non-occurrence is less than or
equal to u. The probability that an event will not have occurred by a
particular month T is given by the expression

\[\label{eq:probnon}
  \prod_{t=0..T} (1-p_{t})\]

Where \(p_{t}\) is the probability of the event’s occurrence in period t
conditioned on it not having occurred at any time before t. Since
\((1-p_{t})\) is always between 0 and 1, the expression given above is
nonincreasing in \(T\). Consequently, beginning with \(t = 0\) we can
successively multiply the \((1-p_{t})\) terms together until the value
of the product falls below u. What Socsim does is mathematically
equivalent to this procedure, however, the implementation in function
takes advantage of fact that the probabilities can be the same over
months or years and works with powers of \((1-p_{t})\).

# Heterogeneity multipliers

Heterogeneity beyond that which follows from the algorithm described in
Section [0.2](#sec:datev) is often desirable in microsimulation. Socsim
increases heterogeneity of fertility for example, in order to create
more realistic sibling set sizes and to allow for heritability of
fertility.

Heterogeneity of mortality and group transitions are not included by
default but much code is in place to allow users to add these features
easily in a way that makes sense for a particular simulation.

The general principle is that if each person at risk of an event is
given a value \(\theta\) drawn from a distribution with mean=1 and the
hazard rates used for generating each individual’s waiting time for the
event are multiplied by \(\theta\), then \(E(h\theta)=h\). Where \(h\)
is the original hazard of the event. Thus the overall population’s event
history should still reflect the rate structure but with greater
variance/heterogeneity.

## Fertility multiplier (fmult)

When the heterogeneous fertility option,() is enabled, each female in
the population is assigned a fertility multiplier. For the initial
population these multipliers may be read in the file or they may be
generated by Socsim. Females born during the simulation will have
multipliers generated by Socsim. Once assigned, fertility multipliers
remain with the woman for her entire life increasing or reducing
proportionally the hazard of giving birth at each.

In the current implementation, individual fertility multipliers, s, are
pseudorandomly distributed as a cubic approximation to the beta
distribution with mean 1.0, variance 0.416, and a range of 0 to 2.4.
Fertility heterogeneity is also heritable to a degree determined by the
user specified directives and .

## Inheritance of Fertility Multipliers

The degree to which heterogeneous fertility is inherited is determined
by the (\(\alpha\)) and (\(\beta\)) directives.
Equation [\[eq:inheritfert\]](#eq:inheritfert) defines the algorithm
used to effect the inheritance. At birth females are first assigned a
fertility multiplier as according to the beta distribution described in
Section [1.1](#sec:fmult) this is \(\gamma\) in
Equation [\[eq:inheritfert\]](#eq:inheritfert). The temporary variable
\(x\) gets the \(\alpha\) weighted average of \(\gamma\) and ego’s
mother’s fertility multiplier. If \(\beta=1\) then \(x\) is the
daughter’s fertility multiplier. Otherwise it is further modified by
the second equation.

\[\begin{aligned}
  x &=& \alpha *\mathrm{fmult}_{\mathrm{mother}} + (1-\alpha)*\gamma\\ 
\label{eq:inheritfert}
  \mathrm{fmult}_{\mathrm{daughter}} &=& 2.5* \exp^{\beta*log(\frac{x}{2.5})} \end{aligned}\]
